[build]
# 针对macOS的编译优化
rustflags = ["-C", "target-cpu=native"]

[target.aarch64-apple-darwin]
# macOS ARM64 (M1/M2)
rustflags = ["-C", "target-cpu=native", "-C", "link-arg=-undefined", "-C", "link-arg=dynamic_lookup"]

[target.x86_64-apple-darwin]  
# macOS x86_64
rustflags = ["-C", "target-cpu=native", "-C", "link-arg=-undefined", "-C", "link-arg=dynamic_lookup"]

# 设置编译时的环境变量
[env]
# 禁用某些可能导致问题的优化
CARGO_PROFILE_DEV_CODEGEN_UNITS = "16"
CARGO_PROFILE_DEV_LTO = "false"
